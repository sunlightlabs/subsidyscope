
{% extends "base.html" %}
{% load media %}
{% load humanize %}
{% load smarterif%}
{% load custom_filters %}
{% block content %}
{% css "styles/faads-search.css" %}
<style>
form#transit-search fieldset { padding: 15px; }
form#transit-search label.text {margin-left: 15px;}
form#transit-search select { width: 100%; margin-right: 25px; padding: 5px; }
#form#transit-search input.submit {width: 80px; background-color: #F6F8FB; border: 1px solid #899EAB; padding: 0 3px; margin-left:10px;}
#form#transit-search input { margin: 15px; padding: 5px;  width: 80%;  }
form#transit-search span.filter-container { width: 40%; float:left; margin-left: 15px;}
.performance-metrics { margin-top:20px;}
.performance-metrics span.metric {display:block; padding: 10px 10px 10px 0px;width:100%; }
.performance-metrics span.metric span.metric-input {text-align:right;}
.performance-metrics span.metric label { display:block; float:left; width: 290px;}
.section div { padding-left:10px;}
.results { width: 100%; margin-top:10px; }
.pages {display:block; text-align:right; width:100%;margin: 30px 5px 5px 0px; padding-top:15px;}
.bottom {margin-top:0px; padding-top:0px;}
</style>


<div class="container main_container">
    {% include "includes/transportation_nav.html" %}
    <span class="span-24">
        <div id="header_area"><h3>Transit System Search</h3></div>
        <div class="content_area">
            <p>Some text on the search and what we're offering can go here I suppose. </p>    
            <form id="faads-search-form" method="post">
            <fieldset id="text-query-wrapper">
                <legend>Search by Transit System Name</legend>
                <div id="text-query-text-wrapper"> 
                <input id="id_text_query" value="{{form.system_name}}" name="system_name" type="text" class="name-search" {% if context.0 != "" %}value="{{context.0}}" {% endif %} />
                </div>
            </fieldset>
            <fieldset id="advanced-options" class="collapsed">
                <legend id="advanced-options">Advanced Options</legend>
                <div class="section">
                    <h4>Mode</h4>
                    <div id="assistance-action-recipient-wrapper" class="field-wrapper">
                        <div class="dropdown-wrapper">
                            <ul>
                            {% for m in modes %}
                                <li><label for="{{m.0}}"><input type="checkbox" name="modes_selected" value="{{m.0}}" {%if form and m.0|in_list:form.modes_selected %} checked {% endif %}  />{{m.1}}</label></li>
                                {% if forloop.counter|divisibleby:"5" %}
                                </ul></div><div class="dropdown-wrapper"><ul>
                                {% endif %}
                            {% endfor %}
                            </ul>
                        </div>
                    </div>
                    <div class="clear-left"></div>
                </div>
                <div class="section" style="padding-bottom:20px;">
                    <h4>Size of Urban Area</h4>
                    <div id="program-selector" style="padding-top:10px;">
                        <ul>
                            <li><label for="urban-select"><input id="urban-select" type="radio" name="size_select" value="urban" {% if form.size_select == "urban"%} checked {% endif %}/>Urban</label></li>
                            <li><label for="rural-select"><input id="rural-select" type="radio" name="size_select" value="rural" {% if form.size_select == "rural"%} checked {% endif %}/>Rural</label></li>
                            <li><label for="both-select"><input id="both-select" type="radio" name="size_select" value="both" {% if form.size_select == "both" or form.size_select == "on" %} checked {% endif %} />Both</label></li>
                            <li style="padding-left:45px;">Rural transit systems serve urbanized areas with less than 50,000 people</li>
                        </ul>
                    </div>
                    <div class="clear-left"></div>
                </div>
                <div class="section">
                    <h4>Location</h4>
                    <div class="dropdown-wrapper" style="padding-top:10px;">
                        <label for="state-select">By State:</label>
                        <select id="state-select" name="state_select">
                                <option value=""></option>
                            {% for state in states %}
                                <option value="{{state.abbreviation}}" {% if form.state_select == state.abbreviation%} selected {% endif %}>{{state.name}}</option>    
                            {% endfor %} 
                        </select>
                        <span style="padding-left: 60px;padding-right:60px;font-weight:bold;">&mdash; or &mdash;</span>
                        <label for="uza-select">By Urban Area:</label>
                        <select id="uza-select" name="uza_select">
                                <option value=""></option>
                            {% for u in uza %}
                                <option value="{{u.id}}" {% if form.uza_select == u.id|stringformat:"s" %} selected {% endif %}>{{u.name}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="clear-left" style="margin-bottom:40px;"></div>
                </div>               
                <div class="section last">
                    <h4>Performance Metrics</h4>
                    <div class="performance-metrics" >
                        <span class="metric"><label for="ofppm">Operations Funding per passenger mile: </label>&nbsp;
                            <span class="metric-input"><input id="ofppm" type="text" name="ofppm_start" {% if form.ofppm_start %} value="{{form.ofppm_start}}" {% endif %} />
                                <span style="padding-left:30px;padding-right: 30px;">&mdash;to&mdash;</span><input type="text" name="ofppm_end" {% if form.ofppm_end %} value="{{form.ofppm_end}}" {% endif %}/></span></span>   
                        
                        <span class="metric"><label for="cfppm">Capital Funding per passenger mile: </label>&nbsp;<input id="cfppm" type="text" name="cfppm_start" {%if form.cfppm_start %} value="{{form.cfppm_start}}" {% endif %}/>
                            <span style="padding-left:30px;padding-right: 30px;">&mdash;to&mdash;</span><input type="text" name="cfppm_end" {% if form.cfppm_end %}value="{{form.cfppm_end}}"{% endif %} /></span>   
                        
                        <span class="metric"><label for="ofpupt">Operations Funding per unlinked passenger trip: </label>&nbsp;<input id="ofpupt" type="text" name="ofpupt_start" {% if form.ofpupt.start %}value="{{form.ofpupt_start}}" {% endif %}/>
                            <span style="padding-left:30px;padding-right: 30px;">&mdash;to&mdash;</span><input type="text" name="ofpupt_end" {% if form.ofpupt_end %} value="{{form.ofpupt_end}}" {% endif %}/></span>   
                        
                        <span class="metric"><label for="cfpupt">Capital Funding per unlinked passenger trip: </label>&nbsp;<input id="cfpupt" type="text" name="cfpupt_start" {% if form.cfpupt_start %} value="{{form.cfpupt_start}}" {% endif %}/>
                            <span style="padding-left:30px;padding-right: 30px;">&mdash;to&mdash;</span><input type="text" name="cfpupt_end" {% if form.cfpupt_end %} value="{{form.cfpupt_end}}" {% endif %}/></span>   
                    </div>
                    <div class="clear-left" style="margin-bottom:40px;"></div>
                </div> 
            </fieldset>
            <input type="hidden" name="page" id="page_value" value="" />
            <input id="reset-faads-search" type="button" value="Reset Search" />
            <input type="submit" class="faads-search-submit" value="Search" />
            
            </form>
            {{by_mode}} 
            <div id="results" style="clear:both;">
            {% if error %} {{error}}
            {% else  %}
                {% if paginator %}
                    <span class="pages">
                    {% if paginator.has_previous %}
                        <a href="#" id="prev_page_bottom">&laquo;&nbsp;Previous</a>
                    {% endif %}
                    &nbsp;Page {{paginator.previous_page_number|add:"1"}} of {{num_pages}} &nbsp;
                    {% if paginator.has_next %}
                        <a href="#" id="next_page_bottom">Next&nbsp;&raquo;</a>
                    {% endif %}
                    </span>
                {% endif %}
                <table class="results">
                <tr>
                    <th>Name</th>
                    <th>Mode</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Urbanized Area</th>
                    <th>Compare?</th>
                </tr>

            {% for transit in results %}
                <tr>
                    <td><a href="/transportation/transit/system/{{transit.0.trs_id}}/" >{{transit.0.name}}</a></td>
                    <td>{{transit.1}}
                    <td>{{transit.0.city}}</td>
                    <td>{{transit.0.state}}</td>
                    <td>{{transit.0.urbanized_area.name}}</td>
                    <td><a href="/transportation/transit/compare/{{transit.0.trs_id}}/">Compare this system</a></td>
                </tr>
            {% endfor %}
                </table>
                {% if paginator %}
                    <span class="pages bottom">
                    {% if paginator.has_previous %}
                        <a href="#" id="prev_page">&laquo;&nbsp;Previous</a>
                    {% endif %}
                    &nbsp;Page {{paginator.previous_page_number|add:"1"}} of {{num_pages}} &nbsp;
                    {% if paginator.has_next %}
                        <a href="#" id="next_page">Next&nbsp;&raquo;</a>
                    {% endif %}
                    </span>
                {% endif %}
            {% endif %}
            </div>
        
        </div>
    </span>

</div>

<script type="text/javascript" charset="utf-8">
$(document).ready(function(){
    $("#prev_page, #prev_page_bottom").click(function(e){
        e.preventDefault();
        $("#faads-search-form").find("#page_value").val("{{paginator.previous_page_number}}").end().submit();
    });

    $("#next_page, #next_page_bottom").click(function(e){
        e.preventDefault();
        $("#faads-search-form").find("#page_value").val("{{paginator.next_page_number}}").end().submit();
    });
    
    $('fieldset#advanced-options legend').click(function(){
        $(this).parent().toggleClass('collapsed'); 
    }); 
});
</script>


{% endblock content %}

